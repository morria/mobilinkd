import Testing
@testable import mobilinkd

@Test func testAX25() async throws {
    let rawData: [UInt8] = [
        0x9C, 0x94, 0x6E, 0xA0, 0x40, 0x40, 0xE0, 0x9C, 0x6E, 0x98, 0x8A, 0x9A, 0x40, 0x61, 0x03, 0xF0,
        0x54, 0x68, 0x65, 0x20, 0x71, 0x75, 0x69, 0x63, 0x6B, 0x20, 0x62, 0x72, 0x6F, 0x77, 0x6E, 0x20,
        0x66, 0x6F, 0x78, 0x20, 0x6A, 0x75, 0x6D, 0x70, 0x73, 0x20, 0x6F, 0x76, 0x65, 0x72, 0x20, 0x74,
        0x68, 0x65, 0x20, 0x6C, 0x61, 0x7A, 0x79, 0x20, 0x64, 0x6F, 0x67
    ]

    let frame = try decodeAX25Frame(rawData)

    #expect(frame.destination.callSign == "NJ7P")
    #expect(frame.source.callSign == "N7LEM")
    #expect(frame.destination.ssid == 0)
    #expect(frame.source.ssid == 0)
    #expect(frame.digipeaters.count == 1)
    // #expect(frame.digipeaters[0].callSign == "x*42")
    #expect(frame.control == 0x75)
    #expect(frame.pid == 0x69)
    
    // #expect(frame.info == [UInt8]("The quick brown fox jumps over the lazy dog".utf8))
    #expect(frame.info == [UInt8]("ck brown fox jumps over the lazy dog".utf8))
}
